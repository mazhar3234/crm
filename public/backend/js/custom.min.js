var baseUrl = location.protocol + "//" + location.host + "/";
/*
* load modal for add resource 
**************************************************
*/
function addResource(url) {
    // alert("ok");
    $.ajax({
        url  : baseUrl + url,
        type : "GET",
        success: function(response) {
            $("#modalOutput").html(response);
        },
        error: function() {
            alert("There was might be some problem. Try again...");
        }
    });
};

/*
* load modal for edit resource 
**************************************************
*/
function editResource(url, resourceId) {
    // alert("ok");
    $.ajax({
        url  : baseUrl + url + "/" + resourceId,
        type : "GET",
        success: function(response) {
            $("#modalOutput").html(response);
        },
        error: function() {
            alert("There was might be some problem. Try again...");
        }
    });
};

/*
* delete a resource 
**************************************************
*/
function deleteResource(ele, url, id) {
    var deletedRow = $(ele).parent().parent().parent().parent();
    var title = url.slice(url.search('-') + 1);
    var title = title.charAt(0).toUpperCase() + title.slice(1);
    var title = title.replace(/-/g, " ");
    // alert(title);return;
    $.ajax({
        url: baseUrl + url + "/" + id,
        type: "GET",
        success: function(response) {
            if (response == "1") {
                $(deletedRow).css("background-color", "#ffc6c6");
                $(deletedRow).delay(500).fadeOut("slow");
                $("#message").html("<script type='text/javascript'>toastr.success('" + title + " deleted successfully.');</script>");
            } else {
                $("#message").html("<script type='text/javascript'>toastr.success('Failed! Something went wrong.');</script>");
            }
        },
        error: function() {
            alert("There was might be some problem. Try again...");
        }
    });
};

/*
* Image read function 
**************************************************
*/
var openFile = function(file) {
    var input = file.target;

    var reader = new FileReader();
    reader.onload = function(){
        var dataURL = reader.result;
        var output = document.getElementById("img_prev");
        output.src = dataURL;
    };
    reader.readAsDataURL(input.files[0]);
};

var openFile2 = function(file) {
    var input = file.target;

    var reader = new FileReader();
    reader.onload = function(){
        var dataURL = reader.result;
        var output = document.getElementById("img_prev2");
        output.src = dataURL;
    };
    reader.readAsDataURL(input.files[0]);
};

/*
* Map JS
**************************************************
*/
    var autocomplete;
    function initAutocomplete() {
        // Create the autocomplete object, restricting the search predictions to
        // geographical location types.
        autocomplete = new google.maps.places.Autocomplete(
            document.getElementById('location_name'), {types: ['geocode']});
    }

/*
* Extra JS
**************************************************
*/

// fixed scrolling bar 
var header = document.getElementById("page-subtitle");
if(header) {
    window.onscroll = function() {myFunction()};
    // Get the offset position of the navbar
    var sticky = header.offsetTop;
}
// Remove "sticky" when you leave the scroll position
function myFunction() {
    if (window.pageYOffset > sticky) {
        header.classList.add("sticky");
    } else {
        header.classList.remove("sticky");
    }
}

/*
* Menu JS
**************************************************
*/
var menu = document.getElementById("main-menu");
$(document).ready(function() {
    // get current URL path and assign 'active' class
    if(menu) {
        var pathname = window.location.pathname;
        var pathname = pathname.split('/')[1];
        // alert(pathname);
        $(".vertical-nav-menu").find('li').removeClass('mm-active');
        $(".vertical-nav-menu #"+pathname).addClass('mm-active');
        $(".sidebar-sub-menu #"+pathname+"-nav").addClass('mm-active');

        if(pathname == 'vehicle-class') {
            $(".vertical-nav-menu #vehicles").addClass('mm-active');
            $(".sidebar-sub-menu #"+pathname+"-nav").addClass('mm-active');
        }

        var subpath = pathname.split('-')[1];
        $(".vertical-nav-menu #"+subpath+"s").addClass('mm-active');

        if(pathname == 'create-vehicle-class' || pathname == 'edit-vehicle-class') {
            $(".sidebar-sub-menu #vehicle-class-nav").addClass('mm-active');
        }
        
        if(pathname == 'create-vehicle' || pathname == 'edit-vehicle' || pathname == 'details-vehicle') {
            $(".sidebar-sub-menu #vehicles-nav").addClass('mm-active');
        }
    }
});

$("#add_more").on("click", function(){ 
    $("#cloneDiv:last").clone(true).appendTo(".dd");
    $(".dd").find("#cloneDiv:last input:text").val("");
    $(".dd").find("#cloneDiv:last input").val("");
    $(".dd").find("#add_more").css({"display": "none"});
    $(".dd").find(".rem").css({"display": "inline"});
});

$(".rem").on("click", function(){ 
    $(this).closest("#cloneDiv").remove();
});
